function Counter(){$.extend(this,{opening:new Date($("body").data("opening")),ms:null,verbs:[["\u0434\u0435\u043d\u044c","\u0434\u043d\u044f","\u0434\u043d\u0435\u0439"],["\u0447\u0430\u0441","\u0447\u0430\u0441\u0430","\u0447\u0430\u0441\u043e\u0432"],["\u043c\u0438\u043d\u0443\u0442\u0430","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"]],$el:$(".counter\x3e.count"),timer:null});this.run()}
Counter.prototype={zeropad:function(a){10>a&&(a="0"+a);return a.toString()},declOfNum:function(a,b){var c=[2,0,1,1,1,2];return b[4<a%100&&20>a%100?2:c[5>a%10?a%10:5]]},countTpl:function(a,b){return $('\x3cdiv class\x3d"tell"\x3e'+this.zeropad(a)+'\x3cdiv class\x3d"measure"\x3e\x3cspan\x3e'+b+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e")},maths:function(){this.ms=this.opening-new Date;var a=Math.floor(this.ms/1E3/60/60/24),b=864E5*a,c=Math.floor((this.ms-b)/1E3/60/60);return[a,c,Math.floor((this.ms-(b+
36E5*c))/1E3/60)]},draw:function(){this.$el.empty();this.maths().forEach(function(a,b){this.$el.append(this.countTpl(a,this.declOfNum(a,this.verbs[b])))},this);this.$el.parent().css({visibility:"visible"})},run:function(){null!==this.timer?clearInterval(this.timer):this.draw();this.timer=setInterval(this.draw.bind(this),6E4)}};function Subscribe(a){this.form=a;this.bind()}
Subscribe.prototype={bind:function(){$(":input[name]",this.form).each(function(a,b){Subscribe.options.im[b.name].mask(b)});this.form.on("submit",this.handler.bind(this))},disable:function(a){$('[type\x3d"submit"]').prop("disabled",a)},handler:function(a){a.preventDefault();this.validate()&&this.send()},validate:function(){this.data={};var a=$(":input",this.form);a.removeClass("error");a.each(function(a,b){var f=$(b),e=f.val().trim();e&&(Subscribe.options.im[b.name].isValid(e)?this.data[b.name]=e:
this.showError(f))}.bind(this));var b=$.isEmptyObject(this.data);b&&this.showError(a);return!b},showError:function(a){a.addClass("error")},send:function(){this.data.date=new Date;this.disable(!0);Subscribe.db.save(Subscribe.options.collection,this.data).done(this.success.bind(this)).fail(Subscribe.error)},success:function(){this.disable(!1);this.data={};$.magnificPopup.close();this.form[0].reset();window.location.replace("/thank-you.html")}};Subscribe.error=function(a){a&&console.error(a)};
Subscribe.options={url:"https://example.com",account:"sample",database:"sample",login:"sample",password:"sample",collection:"sample",im:{phone:new Inputmask("+7 (999) 999-99-99"),email:new Inputmask({alias:"email"})}};Subscribe.db={login:function(){return $.when()},save:function(){return $.when()}};Subscribe.connect=function(){Subscribe.db.login("default",Subscribe.options.password).done().fail(Subscribe.error)};
function bindSubscribeForm(a){a=a||document;$(".subscribe-form",a).each(function(a,c){var d=$(c);d.data("subscribe-form")||d.data("subscribe-form",new Subscribe(d))})}$(function(){new Counter;Subscribe.connect();$(document).on("click",".register-btn",function(a){a.preventDefault();$.magnificPopup.open({items:{src:$("#popup-tpl").text(),type:"inline"},callbacks:{open:function(){bindSubscribeForm(this.content)}}})});bindSubscribeForm()});